var ESurksha=function(){"use strict";let n={};function e(){return n}async function t(){const{apiBaseUrl:n,tenantId:t,token:o}=e();return(await fetch(`${n}/user/consents/purposes`,{headers:{Authorization:`Bearer ${o}`,"x-tenant-id":t}})).json()}async function o(){const{apiBaseUrl:n,tenantId:t,token:o}=e();return(await fetch(`${n}/user/consents`,{headers:{Authorization:`Bearer ${o}`,"x-tenant-id":t}})).json()}async function c(n,t){const{apiBaseUrl:o,tenantId:c,token:a}=e();return fetch(`${o}/user/consents`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"x-tenant-id":c,"Content-Type":"application/json"},body:JSON.stringify({consentCode:n,granted:t})})}let a=[];function i(n){a=n}function r(){document.querySelectorAll('script[type="text/plain"][data-es-consent]').forEach(n=>{if(!function(n){const e=a.find(e=>e.code===n);return!(!e||!0!==e.consent_given||e.revoked_at)}(n.dataset.esConsent))return;const e=document.createElement("script");Array.from(n.attributes).forEach(n=>{"type"!==n.name&&e.setAttribute(n.name,n.value)}),e.src=n.src,e.async=!0,n.parentNode.replaceChild(e,n)})}let s=null;async function d(){const n=s.querySelectorAll("input[type=checkbox]");for(const e of n)await c(e.dataset.code,e.checked);i(await o()),r(),u()}function u(){s.remove(),s=null}return{init:async function(e){!function(e){n=e}(e);const a=await t(),s=await o();i(s),r();const d=a.filter(n=>{const e=s.find(e=>e.code===n.code);return!e||(!e.consent_given||e.consent_version<n.version)});d.length>0&&function(n){const e=document.createElement("div");e.style="\n    position: fixed;\n    bottom: 0;\n    width: 100%;\n    background: #111;\n    color: #fff;\n    padding: 20px;\n    z-index: 9999;\n  ",e.innerHTML=`\n    <h3>Privacy Preferences</h3>\n    ${n.map(n=>`\n      <label>\n        <input type="checkbox" data-code="${n.code}">\n        ${n.description}\n      </label><br/>\n    `).join("")}\n    <button id="es-save">Save</button>\n  `,document.body.appendChild(e),document.getElementById("es-save").onclick=async()=>{const n=e.querySelectorAll("input[type=checkbox]");for(const e of n)await c(e.dataset.code,e.checked);e.remove(),r()}}(d)},openPreferences:async function(){if(s)return;const n=await t(),e=await o();i(e),s=document.createElement("div"),s.style="\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.6);\n    z-index: 999999;\n  ";const c=document.createElement("div");c.style="\n    background: white;\n    max-width: 500px;\n    margin: 5% auto;\n    padding: 20px;\n    border-radius: 8px;\n  ",c.innerHTML=`\n    <h2>Privacy Preferences</h2>\n    ${n.map(n=>{const t=e.find(e=>e.code===n.code),o=t?.consent_given?"checked":"",c=n.is_mandatory?"disabled":"";return`\n        <div>\n          <label>\n            <input\n              type="checkbox"\n              data-code="${n.code}"\n              ${o}\n              ${c}\n            />\n            <strong>${n.code}</strong><br/>\n            <small>${n.description}</small>\n          </label>\n        </div>\n        <hr/>\n      `}).join("")}\n    <button id="es-save">Save</button>\n    <button id="es-close">Close</button>\n  `,s.appendChild(c),document.body.appendChild(s),document.getElementById("es-close").onclick=u,document.getElementById("es-save").onclick=d}}}();
//# sourceMappingURL=esurksha-1.1.1.min.js.map
